<?php

namespace {{ class.className.namespace }};

use InvalidArgumentException;

final class {{ class.className.name }}
{
    {% for constant in class.constants %}const {{ constant.name }} = {{ constant.valueForTemplate|raw }};
    {% endfor %}

    /**
     * @param string ${{ class.className.forParameter }}
     */
    private function __construct(${{ class.className.forParameter }})
    {
        if (!in_array(${{ class.className.forParameter }}, self::getPossibleValues(), true)) {
            throw new InvalidArgumentException('Invalid value');
        }

        $this->{{ class.className.forParameter }} = ${{ class.className.forParameter }};
    }

    /**
     * @param string ${{ class.className.forParameter }}
     *
     * @return self
     */
    public static function fromString(${{ class.className.forParameter }})
    {
        return new self(${{ class.className.forParameter }});
    }

    /**
     * @return array
     */
    public static function getPossibleValues()
    {
        return [
        {% for constant in class.constants %}
    self::{{ constant.name }},
        {% endfor -%}];
    }

    /**
     * @return string
     */
    public function __toString()
    {
        return (string) $this->{{ class.className.forParameter }};
    }

    /**
     * @param self ${{ class.className.forParameter }}
     *
     * @return bool
     */
    public function equals(self ${{ class.className.forParameter }})
    {
        if (!(${{ class.className.forParameter }} instanceof $this)) {
            return false;
        }

        return ${{ class.className.forParameter }} == $this;
    }
{% for constant in class.constants %}

    /**
     * @return self
     */
    public static function {{ constant.camelCasedName }}()
    {
        return new self(self::{{ constant.name }});
    }

    /**
     * @return bool
     */
    public function is{{ constant.camelCasedName(true) }}()
    {
        return $this->equals(self::{{ constant.camelCasedName }}());
    }
{% endfor -%}
}
